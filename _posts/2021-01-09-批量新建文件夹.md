---
layout: post
title: 批量新建文件夹
date: 2021-01-09
tags: [教程]
---

* TOC
{:toc}

---

### 1. 源代码

~~~ bat
@echo off
chcp 65001
title 批量新建文件夹
cls

:check
for /f "delims=. tokens=1,2,*" %%i in ('dir /b *.txt') do (
    echo copy "%%i.%%j.%%k" to "%%j"\ 
)
set /p var=命令是否正确无误(Y/N)：
if /i %var%==y (
    goto mkdir & copy file
) else (
    if /i %var%==Y (
        goto mkdir & copy file
    ) else (
        goto exit
    )
)

:mkdir & copy file
echo ==============="%date% %time%"=============== >> undo.txt

for /f "delims=. tokens=1,2,*" %%i in ('dir /b *.txt') do (
    if not exist "%%j" mkdir "%%j"\
    copy "%%i.%%j.%%k" "%%j"\
    echo copy "%%i.%%j.%%k" "%%j"\ >>undo.txt
)

echo =========================================================== >> undo.txt

:exit
pause
~~~

### 2. 使用说明

+ dir /b *.txt 获取扩展名为 .txt 的文件名
+ delims=\[分段标志\]
+ tokens=\[提取段数\]

### 3. 示例

执行前文件目录：

    >123.456.789.0.txt
    >
    >012.123.234.345.txt
    >
    >12.345.txt
    >
    >678.txt

脚本运行后变量：

    >%%i 依次为 "123", "012", "12", "678"
    >
    >%%j 依次为 "456", "123", "345", "txt"
    >
    >%%k 依次为 "789.0.txt", "234.345.txt", "txt", ""

执行命令：

    >copy "012.123.234.345.txt" to "123"\
    >
    >copy "12.345.txt" to "345"\
    >
    >copy "123.456.789.0.txt" to "456"\
    >
    >copy "678.txt." to "txt"\

执行后文件目录：

    >123
    >
    > |--012.123.234.345.txt
    >
    >345
    >
    > |--12.345.txt
    >
    >456
    >
    > |--123.456.789.0.txt
    >
    >txt
    >
    > |--678.txt
    >
    >123.456.789.0.txt
    >
    >012.123.234.345.txt
    >
    >12.345.txt
    >
    >678.txt
    >
    >undo.txt

### 4. 注意

**不建议** 将 copy 改为 move, 虽然已经添加了一些防范措施，如命令确认、执行日志，但仍有数据丢失风险。

**数据无价！** 

使用该脚本需多加小心